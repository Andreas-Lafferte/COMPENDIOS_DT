`2012`=sum(.$`2012`[18]),
`2013`=sum(.$`2013`[18]),
`2014`=sum(.$`2014`[18]),
`2015`=sum(.$`2015`[18]),
`2016`=sum(.$`2016`[18]),
`2017`=sum(.$`2017`[18]))
cuadro3_3_r<-cuadro3_3 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2018`=sum(.$`2018`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2018`=sum(.$`2018`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2018`=sum(.$`2018`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2018`=sum(.$`2018`[4]+.$`2018`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2018`=sum(.$`2018`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2018`=sum(.$`2018`[7]+.$`2018`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2018`=sum(.$`2018`[8]+.$`2018`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2018`=sum(.$`2018`[11]+.$`2018`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2018`=sum(.$`2018`[13]+.$`2018`[14]+.$`2018`[15]+.$`2018`[16]+.$`2018`[17]+.$`2018`[18]+.$`2018`[19]+.$`2018`[20]+.$`2018`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2018`=sum(.$`2018`[22]))
cuadro3<-merge(cuadro3_1,cuadro3_2_r,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro3<-merge(cuadro3,cuadro3_3_r,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro3<-unique( cuadro3 )
cuadro3<-cuadro3[-3,]
# Grafico 3
cuadro3 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,sindicatos,-Rama.Actividad.Económica) %>% mutate(tasa=as.numeric(sindicatos),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=sindicatos,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Cantidad de sindicatos activos a nivel nacional, por rama de actividad económica",
x="Anos",
y = "Sindicatos activos",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) + scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/1. OOSS/grafico3.Cantidad de sindicatos activos a nivel nacional, por rama de actividad económica.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
#### Cuadro 3 solo 2018 (ramas desagregadas)
cuadro3_3 %>% filter(Rama.Actividad.Económica!="Total") %>%
ggplot(aes(x=as.factor(reorder(Rama.Actividad.Económica,`2018`)),y=`2018`))+
geom_bar(stat="identity", fill="#3399FF", colour="black", width=0.8) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE)) +
theme_bw() +  coord_flip() +
geom_text(aes(label = format(`2018`, big.mark = ".", scientific = FALSE)), hjust=-0.5, colour = "black", size=3.0) +
labs(title="Cantidad de sindicatos activos a nivel nacional, por rama de actividad económica en 2018",
x="Ramas de actividad económica",
y = "Sindicatos")
#### Cuadro 4. y 5. Cantidad de afiliados ####
## 1990 a 2001
cuadro4_1<-cbind(
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 10,rows=c(1:12),cols=c(1:7),na.strings = "**"),
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 11,rows=c(2:13),cols=c(2:7),na.strings = "**")
)
## 2002 a 2010
a<-read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 12,rows=c(4:14),cols=c(1:10),na.strings = "**",colNames = FALSE)
b<-read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 13,rows=c(3:13),cols=c(2:10),na.strings = "**",colNames = FALSE)
c<-read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 14,rows=c(3:13),cols=c(2:10),na.strings = "**",colNames = FALSE)
names(a)<-c("Rama.Actividad.Económica","h2","m2","t2","h3","m3","t3","h4","m4","t4")
names(b)<-c("h5","m5","t5","h6","m6","t6","h7","m7","t7")
names(c)<-c("h8","m8","t8","h9","m9","t9","h10","m10","t10")
cuadro4_2_sexo<-cbind(a,b,c)
cuadro4_2<-cuadro4_2_sexo %>% select(1,4,7,10,13,16,19,22,25,28)
## 2011 a 2017
cuadro4_3_sexo<-cbind(
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 15,rows=c(4:22),cols=c(1:7),na.strings = "**",colNames = FALSE),
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 16,rows=c(4:22),cols=c(2:7),na.strings = "**",colNames = FALSE),
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 17,rows=c(4:22),cols=c(2:7),na.strings = "**",colNames = FALSE),
read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 18,rows=c(4:22),cols=c(2:4),na.strings = "**",colNames = FALSE)
)
names(cuadro4_3_sexo)<-c("Rama.Actividad.Económica","h11","m11","t11","h12","m12","t12","h13","m13","t13","h14","m14","t14",
"h15","m15","t15","h16","m16","t16","h17","m17","t17")
cuadro4_3<-cuadro4_3_sexo %>% select(1,4,7,10,13,16,19,22)
## 2018
cuadro4_4_sexo<-read.xlsx("Input/Ilovepdf/1. OOSS.xlsx",sheet = 19,rows=c(3:26),cols=c(1:4),na.strings = "**")
names(cuadro4_4_sexo)<-c("Rama.Actividad.Económica","h18","m18","t18")
cuadro4_4<-cuadro4_4_sexo %>% select(1,4)
## A. Primero sin sexo
cuadro4_1
cuadro4_2
colnames(cuadro4_2)<-c("Rama.Actividad.Económica",2002,2003,2004,2005,2006,2007,2008,2009,2010)
colnames(cuadro4_3)<-c("Rama.Actividad.Económica",2011,2012,2013,2014,2015,2016,2017)
cuadro4_3<-cuadro4_3 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2011`=sum(.$`2011`[1]+.$`2011`[2]),
`2012`=sum(.$`2012`[1]+.$`2012`[2]),
`2013`=sum(.$`2013`[1]+.$`2013`[2]),
`2014`=sum(.$`2014`[1]+.$`2014`[2]),
`2015`=sum(.$`2015`[1]+.$`2015`[2]),
`2016`=sum(.$`2016`[1]+.$`2016`[2]),
`2017`=sum(.$`2017`[1]+.$`2017`[2])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2011`=sum(.$`2011`[3]),
`2012`=sum(.$`2012`[3]),
`2013`=sum(.$`2013`[3]),
`2014`=sum(.$`2014`[3]),
`2015`=sum(.$`2015`[3]),
`2016`=sum(.$`2016`[3]),
`2017`=sum(.$`2017`[3])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2011`=sum(.$`2011`[4]),
`2012`=sum(.$`2012`[4]),
`2013`=sum(.$`2013`[4]),
`2014`=sum(.$`2014`[4]),
`2015`=sum(.$`2015`[4]),
`2016`=sum(.$`2016`[4]),
`2017`=sum(.$`2017`[4])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2011`=sum(.$`2011`[5]),
`2012`=sum(.$`2012`[5]),
`2013`=sum(.$`2013`[5]),
`2014`=sum(.$`2014`[5]),
`2015`=sum(.$`2015`[5]),
`2016`=sum(.$`2016`[5]),
`2017`=sum(.$`2017`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2011`=sum(.$`2011`[6]),
`2012`=sum(.$`2012`[6]),
`2013`=sum(.$`2013`[6]),
`2014`=sum(.$`2014`[6]),
`2015`=sum(.$`2015`[6]),
`2016`=sum(.$`2016`[6]),
`2017`=sum(.$`2017`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2011`=sum(.$`2011`[7]+.$`2011`[8]),
`2012`=sum(.$`2012`[7]+.$`2012`[8]),
`2013`=sum(.$`2013`[7]+.$`2013`[8]),
`2014`=sum(.$`2014`[7]+.$`2014`[8]),
`2015`=sum(.$`2015`[7]+.$`2015`[8]),
`2016`=sum(.$`2016`[7]+.$`2016`[8]),
`2017`=sum(.$`2017`[7]+.$`2017`[8])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2011`=sum(.$`2011`[9]),
`2012`=sum(.$`2012`[9]),
`2013`=sum(.$`2013`[9]),
`2014`=sum(.$`2014`[9]),
`2015`=sum(.$`2015`[9]),
`2016`=sum(.$`2016`[9]),
`2017`=sum(.$`2017`[9])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2011`=sum(.$`2011`[10]+.$`2011`[11]),
`2012`=sum(.$`2012`[10]+.$`2012`[11]),
`2013`=sum(.$`2013`[10]+.$`2013`[11]),
`2014`=sum(.$`2014`[10]+.$`2014`[11]),
`2015`=sum(.$`2015`[10]+.$`2015`[11]),
`2016`=sum(.$`2016`[10]+.$`2016`[11]),
`2017`=sum(.$`2017`[10]+.$`2017`[11])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2011`=sum(.$`2011`[12]+.$`2011`[13]+.$`2011`[14]+.$`2011`[15]+.$`2011`[16]+.$`2011`[17]),
`2012`=sum(.$`2012`[12]+.$`2012`[13]+.$`2012`[14]+.$`2012`[15]+.$`2012`[16]+.$`2012`[17]),
`2013`=sum(.$`2013`[12]+.$`2013`[13]+.$`2013`[14]+.$`2013`[15]+.$`2013`[16]+.$`2013`[17]),
`2014`=sum(.$`2014`[12]+.$`2014`[13]+.$`2014`[14]+.$`2014`[15]+.$`2014`[16]+.$`2014`[17]),
`2015`=sum(.$`2015`[12]+.$`2015`[13]+.$`2015`[14]+.$`2015`[15]+.$`2015`[16]+.$`2015`[17]),
`2016`=sum(.$`2016`[12]+.$`2016`[13]+.$`2016`[14]+.$`2016`[15]+.$`2016`[16]+.$`2016`[17]),
`2017`=sum(.$`2017`[12]+.$`2017`[13]+.$`2017`[14]+.$`2017`[15]+.$`2017`[16]+.$`2017`[17])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2011`=sum(.$`2011`[18]),
`2012`=sum(.$`2012`[18]),
`2013`=sum(.$`2013`[18]),
`2014`=sum(.$`2014`[18]),
`2015`=sum(.$`2015`[18]),
`2016`=sum(.$`2016`[18]),
`2017`=sum(.$`2017`[18]))
colnames(cuadro4_4)<-c("Rama.Actividad.Económica",2018)
cuadro4_4<-cuadro4_4 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2018`=sum(.$`2018`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2018`=sum(.$`2018`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2018`=sum(.$`2018`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2018`=sum(.$`2018`[4]+.$`2018`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2018`=sum(.$`2018`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2018`=sum(.$`2018`[7]+.$`2018`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2018`=sum(.$`2018`[8]+.$`2018`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2018`=sum(.$`2018`[11]+.$`2018`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2018`=sum(.$`2018`[13]+.$`2018`[14]+.$`2018`[15]+.$`2018`[16]+.$`2018`[17]+.$`2018`[18]+.$`2018`[19]+.$`2018`[20]+.$`2018`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2018`=sum(.$`2018`[22]))
cuadro4<-merge(cuadro4_1,cuadro4_2,by="Rama.Actividad.Económica")
cuadro4<-merge(cuadro4,cuadro4_3,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro4<-merge(cuadro4,cuadro4_4,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro4<-unique( cuadro4 )
cuadro4<-cuadro4[-3,]
cuadro4 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica) %>% mutate(tasa=as.numeric(afiliados),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=afiliados,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 4. Cantidad de afiliados activos a nivel nacional, por rama de actividad económica",
x="Anos",
y = "Trabajadores sindicalizados",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) + scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/1. OOSS/grafico4.Cantidad de afiliados a nivel nacional, por rama de actividad económica.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
## B. Con sexo (cuadro 5)
#### Guardar tablas ####
library(writexl)
write_xlsx(cuadro1,"Output/Cuadros/1. OOSS/cuadro1.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro2,"Output/Cuadros/1. OOSS/cuadro2.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro3,"Output/Cuadros/1. OOSS/cuadro3.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro4,"Output/Cuadros/1. OOSS/cuadro4.xlsx", col_names = TRUE,format_headers = TRUE)
cuadro4_2_sexo
# hombres
cuadro4_2<-cuadro4_2_sexo %>% select(1,4-2,7-2,10-2,13-2,16-2,19-2,22-2,25-2,28-2)
cuadro4_3<-cuadro4_3_sexo %>% select(1,4-2,7-2,10-2,13-2,16-2,19-2,22-2)
cuadro4_4<-cuadro4_4_sexo %>% select(1,4-2)
colnames(cuadro4_2)<-c("Rama.Actividad.Económica",2002,2003,2004,2005,2006,2007,2008,2009,2010)
colnames(cuadro4_3)<-c("Rama.Actividad.Económica",2011,2012,2013,2014,2015,2016,2017)
cuadro4_3<-cuadro4_3 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2011`=sum(.$`2011`[1]+.$`2011`[2]),
`2012`=sum(.$`2012`[1]+.$`2012`[2]),
`2013`=sum(.$`2013`[1]+.$`2013`[2]),
`2014`=sum(.$`2014`[1]+.$`2014`[2]),
`2015`=sum(.$`2015`[1]+.$`2015`[2]),
`2016`=sum(.$`2016`[1]+.$`2016`[2]),
`2017`=sum(.$`2017`[1]+.$`2017`[2])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2011`=sum(.$`2011`[3]),
`2012`=sum(.$`2012`[3]),
`2013`=sum(.$`2013`[3]),
`2014`=sum(.$`2014`[3]),
`2015`=sum(.$`2015`[3]),
`2016`=sum(.$`2016`[3]),
`2017`=sum(.$`2017`[3])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2011`=sum(.$`2011`[4]),
`2012`=sum(.$`2012`[4]),
`2013`=sum(.$`2013`[4]),
`2014`=sum(.$`2014`[4]),
`2015`=sum(.$`2015`[4]),
`2016`=sum(.$`2016`[4]),
`2017`=sum(.$`2017`[4])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2011`=sum(.$`2011`[5]),
`2012`=sum(.$`2012`[5]),
`2013`=sum(.$`2013`[5]),
`2014`=sum(.$`2014`[5]),
`2015`=sum(.$`2015`[5]),
`2016`=sum(.$`2016`[5]),
`2017`=sum(.$`2017`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2011`=sum(.$`2011`[6]),
`2012`=sum(.$`2012`[6]),
`2013`=sum(.$`2013`[6]),
`2014`=sum(.$`2014`[6]),
`2015`=sum(.$`2015`[6]),
`2016`=sum(.$`2016`[6]),
`2017`=sum(.$`2017`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2011`=sum(.$`2011`[7]+.$`2011`[8]),
`2012`=sum(.$`2012`[7]+.$`2012`[8]),
`2013`=sum(.$`2013`[7]+.$`2013`[8]),
`2014`=sum(.$`2014`[7]+.$`2014`[8]),
`2015`=sum(.$`2015`[7]+.$`2015`[8]),
`2016`=sum(.$`2016`[7]+.$`2016`[8]),
`2017`=sum(.$`2017`[7]+.$`2017`[8])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2011`=sum(.$`2011`[9]),
`2012`=sum(.$`2012`[9]),
`2013`=sum(.$`2013`[9]),
`2014`=sum(.$`2014`[9]),
`2015`=sum(.$`2015`[9]),
`2016`=sum(.$`2016`[9]),
`2017`=sum(.$`2017`[9])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2011`=sum(.$`2011`[10]+.$`2011`[11]),
`2012`=sum(.$`2012`[10]+.$`2012`[11]),
`2013`=sum(.$`2013`[10]+.$`2013`[11]),
`2014`=sum(.$`2014`[10]+.$`2014`[11]),
`2015`=sum(.$`2015`[10]+.$`2015`[11]),
`2016`=sum(.$`2016`[10]+.$`2016`[11]),
`2017`=sum(.$`2017`[10]+.$`2017`[11])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2011`=sum(.$`2011`[12]+.$`2011`[13]+.$`2011`[14]+.$`2011`[15]+.$`2011`[16]+.$`2011`[17]),
`2012`=sum(.$`2012`[12]+.$`2012`[13]+.$`2012`[14]+.$`2012`[15]+.$`2012`[16]+.$`2012`[17]),
`2013`=sum(.$`2013`[12]+.$`2013`[13]+.$`2013`[14]+.$`2013`[15]+.$`2013`[16]+.$`2013`[17]),
`2014`=sum(.$`2014`[12]+.$`2014`[13]+.$`2014`[14]+.$`2014`[15]+.$`2014`[16]+.$`2014`[17]),
`2015`=sum(.$`2015`[12]+.$`2015`[13]+.$`2015`[14]+.$`2015`[15]+.$`2015`[16]+.$`2015`[17]),
`2016`=sum(.$`2016`[12]+.$`2016`[13]+.$`2016`[14]+.$`2016`[15]+.$`2016`[16]+.$`2016`[17]),
`2017`=sum(.$`2017`[12]+.$`2017`[13]+.$`2017`[14]+.$`2017`[15]+.$`2017`[16]+.$`2017`[17])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2011`=sum(.$`2011`[18]),
`2012`=sum(.$`2012`[18]),
`2013`=sum(.$`2013`[18]),
`2014`=sum(.$`2014`[18]),
`2015`=sum(.$`2015`[18]),
`2016`=sum(.$`2016`[18]),
`2017`=sum(.$`2017`[18]))
colnames(cuadro4_4)<-c("Rama.Actividad.Económica",2018)
cuadro4_4<-cuadro4_4 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2018`=sum(.$`2018`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2018`=sum(.$`2018`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2018`=sum(.$`2018`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2018`=sum(.$`2018`[4]+.$`2018`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2018`=sum(.$`2018`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2018`=sum(.$`2018`[7]+.$`2018`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2018`=sum(.$`2018`[8]+.$`2018`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2018`=sum(.$`2018`[11]+.$`2018`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2018`=sum(.$`2018`[13]+.$`2018`[14]+.$`2018`[15]+.$`2018`[16]+.$`2018`[17]+.$`2018`[18]+.$`2018`[19]+.$`2018`[20]+.$`2018`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2018`=sum(.$`2018`[22]))
cuadro5_hombres<-merge(cuadro4_2,cuadro4_3,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro5_hombres<-merge(cuadro5_hombres,cuadro4_4,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro5_hombres<-unique( cuadro5_hombres )
View(cuadro5_hombres)
cuadro5_hombres<-cuadro5_hombres[-3,]
# mujeres
cuadro4_2<-cuadro4_2_sexo %>% select(1,4-1,7-1,10-1,13-1,16-1,19-1,22-1,25-1,28-1)
cuadro4_3<-cuadro4_3_sexo %>% select(1,4-1,7-1,10-1,13-1,16-1,19-1,22-1)
cuadro4_4<-cuadro4_4_sexo %>% select(1,4-1)
colnames(cuadro4_2)<-c("Rama.Actividad.Económica",2002,2003,2004,2005,2006,2007,2008,2009,2010)
colnames(cuadro4_3)<-c("Rama.Actividad.Económica",2011,2012,2013,2014,2015,2016,2017)
cuadro4_3<-cuadro4_3 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2011`=sum(.$`2011`[1]+.$`2011`[2]),
`2012`=sum(.$`2012`[1]+.$`2012`[2]),
`2013`=sum(.$`2013`[1]+.$`2013`[2]),
`2014`=sum(.$`2014`[1]+.$`2014`[2]),
`2015`=sum(.$`2015`[1]+.$`2015`[2]),
`2016`=sum(.$`2016`[1]+.$`2016`[2]),
`2017`=sum(.$`2017`[1]+.$`2017`[2])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2011`=sum(.$`2011`[3]),
`2012`=sum(.$`2012`[3]),
`2013`=sum(.$`2013`[3]),
`2014`=sum(.$`2014`[3]),
`2015`=sum(.$`2015`[3]),
`2016`=sum(.$`2016`[3]),
`2017`=sum(.$`2017`[3])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2011`=sum(.$`2011`[4]),
`2012`=sum(.$`2012`[4]),
`2013`=sum(.$`2013`[4]),
`2014`=sum(.$`2014`[4]),
`2015`=sum(.$`2015`[4]),
`2016`=sum(.$`2016`[4]),
`2017`=sum(.$`2017`[4])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2011`=sum(.$`2011`[5]),
`2012`=sum(.$`2012`[5]),
`2013`=sum(.$`2013`[5]),
`2014`=sum(.$`2014`[5]),
`2015`=sum(.$`2015`[5]),
`2016`=sum(.$`2016`[5]),
`2017`=sum(.$`2017`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2011`=sum(.$`2011`[6]),
`2012`=sum(.$`2012`[6]),
`2013`=sum(.$`2013`[6]),
`2014`=sum(.$`2014`[6]),
`2015`=sum(.$`2015`[6]),
`2016`=sum(.$`2016`[6]),
`2017`=sum(.$`2017`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2011`=sum(.$`2011`[7]+.$`2011`[8]),
`2012`=sum(.$`2012`[7]+.$`2012`[8]),
`2013`=sum(.$`2013`[7]+.$`2013`[8]),
`2014`=sum(.$`2014`[7]+.$`2014`[8]),
`2015`=sum(.$`2015`[7]+.$`2015`[8]),
`2016`=sum(.$`2016`[7]+.$`2016`[8]),
`2017`=sum(.$`2017`[7]+.$`2017`[8])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2011`=sum(.$`2011`[9]),
`2012`=sum(.$`2012`[9]),
`2013`=sum(.$`2013`[9]),
`2014`=sum(.$`2014`[9]),
`2015`=sum(.$`2015`[9]),
`2016`=sum(.$`2016`[9]),
`2017`=sum(.$`2017`[9])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2011`=sum(.$`2011`[10]+.$`2011`[11]),
`2012`=sum(.$`2012`[10]+.$`2012`[11]),
`2013`=sum(.$`2013`[10]+.$`2013`[11]),
`2014`=sum(.$`2014`[10]+.$`2014`[11]),
`2015`=sum(.$`2015`[10]+.$`2015`[11]),
`2016`=sum(.$`2016`[10]+.$`2016`[11]),
`2017`=sum(.$`2017`[10]+.$`2017`[11])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2011`=sum(.$`2011`[12]+.$`2011`[13]+.$`2011`[14]+.$`2011`[15]+.$`2011`[16]+.$`2011`[17]),
`2012`=sum(.$`2012`[12]+.$`2012`[13]+.$`2012`[14]+.$`2012`[15]+.$`2012`[16]+.$`2012`[17]),
`2013`=sum(.$`2013`[12]+.$`2013`[13]+.$`2013`[14]+.$`2013`[15]+.$`2013`[16]+.$`2013`[17]),
`2014`=sum(.$`2014`[12]+.$`2014`[13]+.$`2014`[14]+.$`2014`[15]+.$`2014`[16]+.$`2014`[17]),
`2015`=sum(.$`2015`[12]+.$`2015`[13]+.$`2015`[14]+.$`2015`[15]+.$`2015`[16]+.$`2015`[17]),
`2016`=sum(.$`2016`[12]+.$`2016`[13]+.$`2016`[14]+.$`2016`[15]+.$`2016`[16]+.$`2016`[17]),
`2017`=sum(.$`2017`[12]+.$`2017`[13]+.$`2017`[14]+.$`2017`[15]+.$`2017`[16]+.$`2017`[17])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2011`=sum(.$`2011`[18]),
`2012`=sum(.$`2012`[18]),
`2013`=sum(.$`2013`[18]),
`2014`=sum(.$`2014`[18]),
`2015`=sum(.$`2015`[18]),
`2016`=sum(.$`2016`[18]),
`2017`=sum(.$`2017`[18]))
colnames(cuadro4_4)<-c("Rama.Actividad.Económica",2018)
cuadro4_4<-cuadro4_4 %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`2018`=sum(.$`2018`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`2018`=sum(.$`2018`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`2018`=sum(.$`2018`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`2018`=sum(.$`2018`[4]+.$`2018`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`2018`=sum(.$`2018`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`2018`=sum(.$`2018`[7]+.$`2018`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`2018`=sum(.$`2018`[8]+.$`2018`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`2018`=sum(.$`2018`[11]+.$`2018`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`2018`=sum(.$`2018`[13]+.$`2018`[14]+.$`2018`[15]+.$`2018`[16]+.$`2018`[17]+.$`2018`[18]+.$`2018`[19]+.$`2018`[20]+.$`2018`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`2018`=sum(.$`2018`[22]))
cuadro5_mujeres<-merge(cuadro4_2,cuadro4_3,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro5_mujeres<-merge(cuadro5_mujeres,cuadro4_4,by="Rama.Actividad.Económica",all.x = TRUE)
cuadro5_mujeres<-unique( cuadro5_mujeres )
cuadro5_mujeres<-cuadro5_mujeres[-3,]
cuadro5_hombres<-cuadro5_hombres %>% mutate(sexo="hombres")
cuadro5_mujeres<-cuadro5_mujeres %>% mutate(sexo="mujeres")
View(cuadro5_hombres)
rbind(cuadro5_hombres,cuadro5_mujeres)
cuadro5<-rbind(cuadro5_hombres,cuadro5_mujeres)
View(cuadro4_4_sexo)
View(cuadro5)
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica) %>% mutate(tasa=as.numeric(afiliados),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=afiliados,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~sexo)
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica) %>% mutate(tasa=as.numeric(afiliados),
ano=as.numeric(ano))
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica,-sexo) %>% mutate(tasa=as.numeric(afiliados),
ano=as.numeric(ano))
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica,-sexo) %>% mutate(afiliados=as.numeric(afiliados),
ano=as.numeric(ano))
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica,-sexo) %>% mutate(afiliados=as.numeric(afiliados),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=afiliados,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~sexo)
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica,-sexo) %>% mutate(afiliados=as.numeric(afiliados),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=afiliados,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~sexo) +
labs(title = "Gráfico 5. Cantidad de afiliados activos a nivel nacional, por rama de actividad económica y sexo",
x="Anos",
y = "Trabajadores sindicalizados",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) + scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
cuadro5 %>% filter(Rama.Actividad.Económica!="Total") %>%
gather(ano,afiliados,-Rama.Actividad.Económica,-sexo) %>% mutate(afiliados=as.numeric(afiliados),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=afiliados,color=Rama.Actividad.Económica)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~sexo) +
labs(title = "Gráfico 5. Cantidad de afiliados activos a nivel nacional, por rama de actividad económica y sexo",
x="Anos",
y = "Trabajadores sindicalizados",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) + scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(2002, 2018),breaks = c(2002,2010,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/1. OOSS/grafico5.Cantidad de afiliados a nivel nacional, por rama de actividad económica y sexo.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
write_xlsx(cuadro5,"Output/Cuadros/1. OOSS/cuadro5.xlsx", col_names = TRUE,format_headers = TRUE)
