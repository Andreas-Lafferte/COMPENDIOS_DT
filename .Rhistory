c(1998, 121 ,12608 ,1204, 10.0 ,123507 ,NA),
c(1999, 108 ,10667 ,1308, 12.0 ,103232 ,NA),
c(2000, 125 ,13227 ,1121,  9.0  ,114306 ,NA),
c(2001, 86  ,11591,  805,  9.4  ,127157 ,NA),
c(2002, 117 ,14662 ,1363, 11.6 ,207224 ,NA),
c(2003, 92  ,10443,  802,  8.7 ,  73467 ,NA),
c(2004, 125 ,13013 ,1586, 12.7 ,172858 ,NA),
c(2005, 101 ,11209 ,1131, 11.2 , 99931  ,NA),
c(2006, 134 ,15602 ,1501, 11.2 ,195344 ,NA),
c(2007, 146 ,17294 ,1593, 10.9 ,163770 ,NA),
c(2008, 159 ,17473 ,1701, 10.7 ,202178 ,NA),
c(2009, 171 ,21915 ,1961, 11.5 ,242508 ,NA),
c(2010, 174 ,31799 ,2178, 12.5 ,333822 ,NA),
c(2011, 183 ,22698 ,2227, 12.2 ,257591 ,NA),
c(2012, 161 ,30035 ,1886, 11.7 ,252316 ,NA),
c(2013, 201 ,30638 ,2756, 13.7 ,412379 ,NA),
c(2014, 214 ,41939 ,2463, 11.5 ,443517 ,NA),
c(2015, 174 ,24325 ,2524, 14.5 ,330509 ,NA),
c(2016, 204 ,36876 ,3279, 16.1 ,606590 ,NA),
c(2017, 148 ,19425 ,2406, 16.3 ,383738 ,NA),
c(2018, 143 ,15969 ,2233, 15.6 ,242902 ,15.2)
)
cuadro2<-cuadro2 %>% as.data.frame()
names(cuadro2)<-f0
cuadro2
cuadro2 %>% mutate(`promedio dias`=as.numeric(`promedio dias`)) %>%
ggplot(aes(x=ano,y=`promedio dias`)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 4. Duración promedio",
x="Anos",
y = "Duración (días)",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1997,2001,2005,2009,2012,2014,2018),format(round(`promedio dias`,1),big.mark = ".", scientific = FALSE),"")), vjust=-1,colour="black") +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(1997, 2018),breaks = c(1997,2001,2005,2009,2014,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/3. HUELGAS/grafico4.Duración promedio.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
#### Cuadro por sectores (no está en compendio, construido en base a anuario 2018 y archivo excel en PC)
cuadro3_2018_sexo<-read.xlsx("Input/Ilovepdf/3. HUELGAS (ANUARIO 2018).xlsx",sheet = 3,rows=c(3:26),cols=c(1:5),na.strings = "**")
cuadro3_2018_huelgas<-cuadro3_2018_sexo %>% select(1,2)
names(cuadro3_2018_huelgas)<-c("Rama.Actividad.Económica","huelgas_terminadas")
cuadro3_2018_huelgas<-cuadro3_2018_huelgas %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[4]+.$`huelgas_terminadas`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[7]+.$`huelgas_terminadas`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[8]+.$`huelgas_terminadas`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[11]+.$`huelgas_terminadas`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[13]+.$`huelgas_terminadas`[14]+.$`huelgas_terminadas`[15]+.$`huelgas_terminadas`[16]+.$`huelgas_terminadas`[17]+.$`huelgas_terminadas`[18]+.$`huelgas_terminadas`[19]+.$`huelgas_terminadas`[20]+.$`huelgas_terminadas`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`huelgas_terminadas`=sum(.$`huelgas_terminadas`[22]))
cuadro3_2018_trabajadores<-cuadro3_2018_sexo %>% select(1,5)
names(cuadro3_2018_trabajadores)<-c("Rama.Actividad.Económica","trabajadores")
cuadro3_2018_trabajadores<-cuadro3_2018_trabajadores %>% add_row(Rama.Actividad.Económica="Agricultura  y  pesca",
`trabajadores`=sum(.$`trabajadores`[1])) %>%
add_row(Rama.Actividad.Económica="Minería",
`trabajadores`=sum(.$`trabajadores`[2])) %>%
add_row(Rama.Actividad.Económica="Industria",
`trabajadores`=sum(.$`trabajadores`[3])) %>%
add_row(Rama.Actividad.Económica="Electricidad,  gas  y  agua",
`trabajadores`=sum(.$`trabajadores`[4]+.$`trabajadores`[5])) %>%
add_row(Rama.Actividad.Económica="Construcción",
`trabajadores`=sum(.$`trabajadores`[6])) %>%
add_row(Rama.Actividad.Económica="Comercio",
`trabajadores`=sum(.$`trabajadores`[7]+.$`trabajadores`[9])) %>%
add_row(Rama.Actividad.Económica="Transporte  y  comunicaciones",
`trabajadores`=sum(.$`trabajadores`[8]+.$`trabajadores`[10])) %>%
add_row(Rama.Actividad.Económica="Establecimientos  ftnancieros",
`trabajadores`=sum(.$`trabajadores`[11]+.$`trabajadores`[12])) %>%
add_row(Rama.Actividad.Económica="Servicios",
`trabajadores`=sum(.$`trabajadores`[13]+.$`trabajadores`[14]+.$`trabajadores`[15]+.$`trabajadores`[16]+.$`trabajadores`[17]+.$`trabajadores`[18]+.$`trabajadores`[19]+.$`trabajadores`[20]+.$`trabajadores`[21])) %>%
add_row(Rama.Actividad.Económica="Actividades  no  especiftcadas",
`trabajadores`=sum(.$`trabajadores`[22]))
cuadro3_2018_trabajadores<-cuadro3_2018_trabajadores[c(24:33),]
cuadro3_2018_huelgas     <-cuadro3_2018_huelgas[c(24:33),]
names(cuadro3_2018_trabajadores)<-c("Sector","2018")
names(cuadro3_2018_huelgas)     <-c("Sector","2018")
cuadro3<-read.xlsx("Input/Huelgas legales chile DT por sector.xlsx",sheet = 2,rows=c(1:253),cols=c(1:4),na.strings = "**")
cuadro3<-cuadro3 %>% rename(ano=Año) %>% mutate(ano=round(ano))
cuadro3_TC<-cuadro3 %>%
group_by(ano) %>%
mutate(row = row_number()) %>%
select(Sector,ano,row,TC) %>%
tidyr::pivot_wider(names_from = ano,values_from = TC) %>% select(-c(row)) %>% add_row(Sector="Actividades  no  especiftcadas")
cuadro3_huelgas<-cuadro3 %>%
group_by(ano) %>%
mutate(row = row_number()) %>%
select(Sector,ano,row,huelgas_efectuadas) %>%
tidyr::pivot_wider(names_from = ano,values_from = huelgas_efectuadas) %>% select(-c(row)) %>% add_row(Sector="Actividades  no  especiftcadas")
cuadro3_TC
cuadro3_2018_trabajadores
cuadro3_TC %>% View()
cuadro3_2018_trabajadores %>% View()
cuadro3_TC %>% View()
cuadro3_TC %>% arrange(Sector) %>% View()
cuadro3_2018_trabajadores %>% arrange(Sector) %>% View()
cuadro3_TC %>% arrange(Sector) %>% View()
View(cuadro3_2018_sexo)
View(cuadro3_2018_sexo)
View(cuadro3_2018_trabajadores)
View(cuadro3_TC)
cuadro3_2018_trabajadores<-cuadro3_2018_trabajadores %>% arrange(Sector)
cuadro3_TC <-cuadro3_TC %>% arrange(Sector)
cuadro3_TC[,2]
cuadro3_2018_trabajadores[,2]
rbind(cuadro3_TC,cuadro3_2018_trabajadores[,2])
cbind(cuadro3_TC,cuadro3_2018_trabajadores[,2])
cuadro3_2018_trabajadores<-cuadro3_2018_trabajadores %>% select(2018)
cuadro3_2018_trabajadores<-cuadro3_2018_trabajadores %>% select(`2018`)
cuadro3_2018_trabajadores
cbind(cuadro3_TC,cuadro3_2018_trabajadores)
cuadro3_TC<-cbind(cuadro3_TC,cuadro3_2018_trabajadores)
View(cuadro3_2018_huelgas)
cuadro3_huelgas <-cuadro3_huelgas %>% arrange(Sector)
cuadro3_2018_huelgas<-cuadro3_2018_huelgas %>% arrange(Sector)
cuadro3_2018_huelgas<-cuadro3_2018_huelgas %>% select(`2018`)
cuadro3_huelgas<-cbind(cuadro3_huelgas,cuadro3_2018_huelgas)
cuadro3_huelgas
write_xlsx(cuadro3,"Output/Cuadros/3. HUELGAS/cuadro3_TC.xlsx", col_names = TRUE,format_headers = TRUE)
#### Guardar tablas ####
library(writexl)
write_xlsx(cuadro3,"Output/Cuadros/3. HUELGAS/cuadro3_TC.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro4,"Output/Cuadros/3. HUELGAS/cuadro3_huelgas.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro3_TC,"Output/Cuadros/3. HUELGAS/cuadro3_TC.xlsx", col_names = TRUE,format_headers = TRUE)
write_xlsx(cuadro3_huelgas,"Output/Cuadros/3. HUELGAS/cuadro3_huelgas.xlsx", col_names = TRUE,format_headers = TRUE)
cuadro3_TC
cuadro3_TC %>%
gather(tipo,huelgas,-ano)
cuadro3_TC %>%
gather(tipo,huelgas,-Sector)
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas)) %>%
ggplot(aes(x=ano,y=huelgas,color=tipo)) + geom_line() + geom_point() + theme_bw()
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw()
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw()
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(limits = c(1997, 2018),breaks = c(1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1995,1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
cuadro3_huelgas %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. trabajadores legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,trabajadores,-Sector)
cuadro3_huelgas %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Trabajadores comprometidos en huelgas legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/3. HUELGAS/grafico6.TC_por_sector.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
cuadro3_huelgas %>%
gather(ano,huelgas,-Sector) %>% mutate(huelgas=as.numeric(huelgas),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=huelgas,color=Sector)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 3. Huelgas legales por sector económico",
x="Anos",
y = "Huelgas",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/3. HUELGAS/grafico5.Huelgas_por_sector.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~Sector)
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~Sector) +
labs(title = "Gráfico 3. Trabajadores comprometidos en huelgas legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,1993,1997,2001,2005,2009,2014,2018))
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~Sector) +
labs(title = "Gráfico 3. Trabajadores comprometidos en huelgas legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,2000,2009,2018))
cuadro3_TC %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~Sector) +
labs(title = "Gráfico 3. Trabajadores comprometidos en huelgas legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,2005,2018))
cuadro3_TC %>% filter(Sector!="Actividades  no  especiftcadas") %>%
gather(ano,trabajadores,-Sector) %>% mutate(trabajadores=as.numeric(trabajadores),
ano=as.numeric(ano)) %>%
ggplot(aes(x=ano,y=trabajadores,color=Sector)) + geom_line() + geom_point() + theme_bw() + facet_wrap(~Sector) +
labs(title = "Gráfico 3. Trabajadores comprometidos en huelgas legales por sector económico",
x="Anos",
y = "trabajadores",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
scale_y_continuous(labels=function(x) format(x, big.mark = ".", scientific = FALSE))+
scale_x_continuous(breaks = c(1990,2005,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/3. HUELGAS/grafico7.TC_por_sector_facet.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
library(tidyverse)
library(ggrepel)
library(openxlsx)
library(tibble)
# 1. OOSS -----------------------------------------------------------------
#### Cuadro1. Cantidad de sindicatos activos, poblacion afiliada a sindicatos activos, fuerza de trabajo y tasas de sindicalización, años 1990 a 1999 ####
f0<-c("ano",
"sindicatos_activos",
"poblacion_afiliada",
"ft_ocupada1",
"tasa_sind1",
"ft_ocupada2",
"tasa_sind2",
"poblacion_afiliada_sind_dep",
"ft_ocupada3",
"tasa_sind3")
cuadro1<-rbind(
c(1990 ,NA   ,606812 ,4525530 ,13.4, 3745599, 16.2, 515825 ,2692459, 19.2),
c(1991 ,7707 ,701355 ,4630670 ,15.1, 3862016, 18.2, 586716 ,2765416, 21.2),
c(1992 ,8323 ,724065 ,4877430 ,14.8, 4054999, 17.9, 602435 ,2909679, 20.7),
c(1993 ,7974 ,684361 ,5109290 ,13.4, 4280082, 16.0, 569066 ,3067602, 18.6),
c(1994 ,7891 ,661966 ,5122760 ,12.9, 4305265, 15.4, 547862 ,3038135, 18.0),
c(1995 ,7505 ,637570 ,5174410 ,12.3, 4364825, 14.6, 518094 ,3100665, 16.7),
c(1996 ,NA   , NA     ,5298680 ,NA   ,4525632 ,NA   ,NA      ,3243452,  NA),
c(1997 ,7446 ,617761 ,5380190 ,11.5, 4643794, 13.3, 501386 ,3350654, 15.0),
c(1998 ,7439 ,611535 ,5432350 ,11.3, 4657376, 13.1, 489957 ,3276276, 15.0),
c(1999 ,7057 ,579996 ,5404480 ,10.7, 4552804, 12.7, 463071 ,3192874, 14.5),
c(2000, 7659, 595495, 5381460, 11.1, 4528339, 13.2, 467835, 3170319, 14.8),
c(2001, 7410, 599610, 5479390, 10.9, 4631937, 12.9, 466138, 3187987, 14.6),
c(2002, 8149, 618930, 5531260, 11.2, 4723018, 13.1, 481749, 3253178, 14.8),
c(2003, 8967, 669507, 5675130, 11.8, 4849564, 13.8, 519687, 3326674, 15.6),
c(2004, 9416, 680351, 5862900, 11.6, 4979719, 13.7, 533175, 3423609, 15.6),
c(2005, 9148, 676368, 5904999, 11.5, 5054172, 13.4, 539326, 3581293, 15.1),
c(2006, 9424, 703706, 6410982, 11.0, 5477846, 12.8, 568856, 3933474, 14.5),
c(2007, 9365, 724606, 6567241, 11.0, 5622264, 12.9, 607190, 4099492, 14.8),
c(2008, 9340, 801251, 6740408, 11.9, 5782781, 13.9, 685763, 4251018, 16.1),
c(2009, 9776, 837055, 6710990, 12.5, 5747152, 14.6, 712814, 4131857, 17.3),
c(2010, 9871  ,858571,  7353835, 11.7, 6172536, 13.9, 734495  ,4646299, 15.8),
c(2011 ,10310 ,892365,  7564346, 11.8, 6348945, 14.1, 765138  ,4863073, 15.7),
c(2012 ,10585 ,940603,  7699431, 12.2, 6441986, 14.6, 821041  ,4960005, 16.6),
c(2013 ,10634 ,940222,  7904048, 11.9, 6600648, 14.2, 823722  ,5024782, 16.4),
c(2014 ,11162 ,985770,  8013717, 12.3, 6686276, 14.7, 859093  ,5061592, 17.0),
c(2015 ,11433 ,1048234, 8136356, 12.9, 6815314, 15.4, 919315  ,5133964, 17.9),
c(2016 ,11653 ,1139955 ,8216865 ,13.9 ,6901108 ,16.5 ,1009255 ,5142873, 19.6),
c(2017 ,11916 ,1179445 ,8406527 ,14.0 ,6930930 ,17.0 ,1043865 ,5099920, 20.5),
c(2018 ,11920 ,1174346 ,8414056 ,14.0 ,6927523 ,17.0 ,1045300 ,5068372, 20.6)
)
cuadro1<-cuadro1 %>% as.data.frame()
names(cuadro1)<-f0
cuadro1
# Grafico 1
cuadro1 %>% select(ano,tasa_sind1,tasa_sind2,tasa_sind3) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de las tasas de sindicalizacion de la poblacion afiliada a sindicatos activos",
x="Anos",
y = "Porcentaje",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(paste0(round(tasa,1),"%")),"")), vjust=-1,colour="black")
View(cuadro1)
cuadro1 %>% select(ano,poblacion_afiliada,poblacion_afiliada_sind_dep) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(paste0(round(tasa,1),"%")),"")), vjust=-1,colour="black")
cuadro1 %>% select(ano,poblacion_afiliada,poblacion_afiliada_sind_dep) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(tasa),"")), vjust=-1,colour="black")
cuadro1 %>% select(ano,poblacion_afiliada,poblacion_afiliada_sind_dep) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(tasa, big.mark = ".", scientific = FALSE),"")), vjust=-1,colour="black")
cuadro1 %>% select(ano,poblacion_afiliada,poblacion_afiliada_sind_dep) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(tasa, big.mark = ".", scientific = FALSE),"")), vjust=-1,colour="black") +
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/1. OOSS/grafico1.B Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
View(cuadro1)
cuadro1 %>% select(ano,poblacion_afiliada,poblacion_afiliada_sind_dep,sindicatos_activos) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(tasa, big.mark = ".", scientific = FALSE),"")), vjust=-1,colour="black") +
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
cuadro1 %>% select(ano,sindicatos_activos) %>%
gather(tipo,tasa,-ano) %>% mutate(tasa=as.numeric(tasa)) %>%
ggplot(aes(x=ano,y=tasa,color=tipo)) + geom_line() + geom_point() + theme_bw() +
labs(title = "Gráfico 1. Evolución de los y las afiliadas a sindicatos activos en Chile. Según dependencia del sindicato.",
x="Anos",
y = "Trabajadores/as",
caption = "Fuente: Compendio estadístico Dirección del Trabajo") +
theme(legend.position = "bottom",plot.title = element_text(size=12),
plot.subtitle = element_text(size=10),
plot.caption = element_text(size=8)) +
geom_text_repel(aes(label=ifelse(ano%in%c(1991,1995,2000,2004,2009,2015,2018),format(tasa, big.mark = ".", scientific = FALSE),"")), vjust=-1,colour="black") +
scale_x_continuous(limits = c(1990, 2018),breaks = c(1990,2000,2010,2018))
ggsave(
plot = last_plot(),
filename = "Output/Graficos/1. OOSS/grafico1.C Evolución de los sindicatos activos en Chile.png",
device = "png",
dpi = "retina",
units = "cm",
width = 33,
height = 17
)
